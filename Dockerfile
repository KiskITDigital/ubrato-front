FROM node:21.7.1-alpine3.18@sha256:88a2a0bf05ec222e3b42ba6609c880a3acfa4e98693632aee13686a6b6595c2c

ARG SERVER_URI
ENV VITE_SERVER_URI=${SERVER_URI}

ARG SSR_PORT
ENV SSR_PORT=${SSR_PORT}

ARG NODE_ENV
ENV NODE_ENV=${NODE_ENV}

WORKDIR /app
COPY . .
RUN npm install
RUN npm run build
ENTRYPOINT ["node", "server"]